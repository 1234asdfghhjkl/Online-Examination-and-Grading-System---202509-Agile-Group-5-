{% extends "base.html" %}

{% block title %}Create Exam · Online Exam System{% endblock %}

{% block content %}
<div class="card card-main">
    <div class="card-header">
        <h3>Create New Exam</h3>
        <p>Step 1 of 3 · Define the basic exam details.</p>
    </div>

    <div class="card-body p-4">

        <!-- Stepper -->
        <div class="stepper">
            <div class="stepper-item">
                <div class="step-circle current">1</div>
                <span class="step-label">Exam Details</span>
                <div class="step-caption">You are here</div>
            </div>
            <div class="stepper-item">
                <div class="step-circle next">2</div>
                <span class="step-label">Add Questions</span>
                <div class="step-caption">MCQ / Short Answer</div>
            </div>
            <div class="stepper-item">
                <div class="step-circle next">3</div>
                <span class="step-label">Review & Publish</span>
                <div class="step-caption">Coming later</div>
            </div>
        </div>

        <!-- Flash messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            <div class="mb-3">
              {% for category, msg in messages %}
                <div class="alert alert-{{ 'danger' if category == 'error' else 'success' }} d-flex align-items-center" role="alert">
                    {% if category == 'error' %}
                        <span class="badge bg-danger me-2">Error</span>
                    {% else %}
                        <span class="badge bg-success me-2">Success</span>
                    {% endif %}
                    <div>{{ msg }}</div>
                </div>
              {% endfor %}
            </div>
          {% endif %}
        {% endwith %}

        <form action="/create-exam" method="POST" class="row g-3">

            <div class="col-12">
                <label class="form-label" for="title">Exam Title</label>
                <input
                    type="text"
                    id="title"
                    name="title"
                    class="form-control"
                    placeholder="e.g. Web Programming Midterm"
                    value="{{ exam.title if exam else '' }}"
                    required
                >

            </div>

            <div class="col-12">
                <label class="form-label" for="description">Description</label>
                <textarea
                    id="description"
                    name="description"
                    class="form-control"
                    rows="3"
                    placeholder="Briefly describe what this exam will cover."
                    required
                >{{ exam.description if exam else '' }}</textarea>
            </div>

            <div class="col-md-6">
                <label class="form-label" for="duration">Duration (minutes)</label>
                <input
                    type="number"
                    id="duration"
                    name="duration"
                    class="form-control"
                    value="{{ exam.duration if exam else '' }}"
                    placeholder="e.g. 60"
                    min="1"
                    required
                >
            </div>

            <div class="col-md-6">
                <label class="form-label" for="exam_date">Exam Date</label>
                <input
                    type="date"
                    id="exam_date"
                    name="exam_date"
                    class="form-control"
                    value="{{ exam.exam_date if exam else '' }}"
                    required
                >
            </div>


            <div class="col-md-6">
                <label class="form-label">Exam Mode</label>
                <input
                    type="text"
                    class="form-control"
                    value="Online"
                    disabled
                >
            </div>

            <div class="col-12">
                <label class="form-label" for="instructions">Instructions for Students</label>
                <textarea
                    id="instructions"
                    name="instructions"
                    class="form-control"
                    rows="4"
                    placeholder="Example: Ensure a stable internet connection. Do not refresh the page during the exam."
                    required
                >{{ exam.instructions if exam else '' }}</textarea>
            </div>

            <div class="col-12 d-flex justify-content-between align-items-center mt-2">
                <div class="text-muted small">
                    After saving, you can add MCQs or Short Answer questions.
                </div>
                <button type="submit" class="btn btn-primary">
                    Next
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
